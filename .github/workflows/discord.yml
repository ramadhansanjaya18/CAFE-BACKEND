name: Discord Professional Notification

on:
  push:
    branches:
      - main
      - develop
      - feature/**
  pull_request:
    types: [opened, closed]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Clean Discord Embed
        run: |
          REPO="${{ github.repository }}"
          AUTHOR="${{ github.actor }}"
          BRANCH="${{ github.ref_name }}"
          COMMIT_MSG="${{ github.event.head_commit.message }}"
          COMMIT_URL="${{ github.event.head_commit.url }}"
          EVENT="${{ github.event_name }}"

          curl -H "Content-Type: application/json" \
          -X POST \
          -d "{
            \"embeds\": [{
              \"title\": \"ðŸš€ ${REPO}\",
              \"description\": \"**${COMMIT_MSG}**\",
              \"color\": 3447003,
              \"fields\": [
                {
                  \"name\": \"ðŸ‘¤ Author\",
                  \"value\": \"${AUTHOR}\",
                  \"inline\": true
                },
                {
                  \"name\": \"ðŸŒ¿ Branch\",
                  \"value\": \"${BRANCH}\",
                  \"inline\": true
                },
                {
                  \"name\": \"ðŸ“Œ Event\",
                  \"value\": \"${EVENT}\",
                  \"inline\": true
                }
              ],
              \"url\": \"${COMMIT_URL}\",
              \"footer\": {
                \"text\": \"CoffeeJob Dev Team â€¢ GitHub Automation\"
              },
              \"timestamp\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\"
            }]
          }" \
          ${{ secrets.DISCORD_WEBHOOK }}
